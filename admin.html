<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GHS Global Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
 <!-- Favicon -->
<link rel="icon" href="/favicon.ico">
<link rel="icon" href="https://i.ibb.co/mrWQCrrb/blob.jpg" sizes="512x512">
<link rel="apple-touch-icon" href="https://ik.imagekit.io/s95tumxuk/1763291103188.jpg">
<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#4CAF50;
  --primary-dark:#2E7D32;
  --accent:#ff6600;
  --bg:#f4f6f9;
  --card:#ffffff;
  --radius:14px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Inter',sans-serif;
  background:var(--bg);
  color:#333;
}

/* ===== HEADER ===== */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 24px;
  background:linear-gradient(135deg,var(--primary),var(--primary-dark));
  color:#fff;
}

.header-left{
  display:flex;
  align-items:center;
  gap:15px;
}

.logo{
  width:52px;
  height:52px;
  background:rgba(255,255,255,0.2);
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

.logo img{
  width:100%;
  height:100%;
  object-fit:contain;
}


.header-right{
  display:flex;
  align-items:center;
  gap:8px;
}

.status-dot{
  width:10px;
  height:10px;
  background:#00ff00;
  border-radius:50%;
}

/* ===== LAYOUT ===== */
.container{
  max-width:1200px;
  margin:40px auto;
  padding:0 20px;
}

h2{
  text-align:center;
  margin-bottom:25px;
}

/* ===== CARDS ===== */
.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:25px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
  margin-bottom:40px;
}

/* ===== FORMS ===== */
form{
  display:flex;
  flex-direction:column;
  gap:15px;
}

input, textarea{
  padding:14px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
}

button{
  padding:14px;
  border:none;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
}

.btn-primary{background:var(--primary);color:#fff}
.btn-danger{background:#dc3545;color:#fff}
.btn-edit{background:#28a745;color:#fff}

/* ===== GRID ===== */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
  gap:20px;
}

.image-card img{
  width:100%;
  height:180px;
  object-fit:cover;
  border-radius:12px;
}

/* ================= LOGIN PAGE STYLES ================= */

#loginOverlay {
  position: fixed;
  inset: 0;
  background:
    linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.55)),
    url("https://images.unsplash.com/photo-1524995997946-a1c2e315a42f");
  background-size: cover;
  background-position: center;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  font-family: 'Inter', sans-serif;
}

/* CONTAINER */
.login-container {
  width: 100%;
  max-width: 420px;
  padding: 20px;
}

/* HEADER */
.login-header {
  text-align: center;
  color: #ffffff;
  margin-bottom: 25px;
}

.login-header h1 {
  font-size: clamp(1.8rem, 4vw, 2.3rem);
  font-weight: 800;
  margin-bottom: 6px;
  letter-spacing: 0.5px;
}

.login-header p {
  font-size: 0.95rem;
  opacity: 0.9;
}

/* LOGIN CARD */
.login-box {
  background: #ffffff;
  padding: 28px;
  border-radius: 16px;
  box-shadow: 0 18px 40px rgba(0,0,0,0.25);
}

/* TITLE */
.login-box h3 {
  text-align: center;
  margin-bottom: 22px;
  font-size: 1.2rem;
  color: #111827;
}

/* INPUTS */
.login-box input {
  width: 100%;
  padding: 14px 16px;
  border-radius: 10px;
  border: 1px solid #d1d5db;
  margin-bottom: 16px;
  font-size: 0.95rem;
}

.login-box input:focus {
  outline: none;
  border-color: #14532d;
  box-shadow: 0 0 0 2px rgba(20, 83, 45, 0.15);
}

/* BUTTON */
.btn-primary {
  width: 100%;
  padding: 14px;
  border-radius: 10px;
  border: none;
  background: #14532d;
  color: #ffffff;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: background 0.2s ease;
}

.btn-primary:hover {
  background: #0f3d22;
}

/* ERROR MESSAGE */
#loginError {
  margin-top: 12px;
  font-size: 0.9rem;
  color: #dc2626;
  text-align: center;
}

/* MOBILE OPTIMIZATION */
@media (max-width: 480px) {
  .login-box {
    padding: 22px;
  }
}

/* ===== RESPONSIVE ===== */
@media(max-width:768px){
  header{flex-direction:column;gap:10px}
}

.image-loader{
  display:none;
  width:36px;
  height:36px;
  border:4px solid #e0e0e0;
  border-top:4px solid #4CAF50;
  border-radius:50%;
  animation: spin 0.8s linear infinite;
  margin:15px auto;
}

@keyframes spin{
  to{ transform:rotate(360deg); }
}
.message-card {
  background: #ffffff;
  border-radius: 14px;
  padding: 18px;
  margin-bottom: 16px;
  box-shadow: 0 10px 28px rgba(0,0,0,0.08);
  border-left: 5px solid #ff0033;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

/* Hover effect */
.message-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 14px 34px rgba(0,0,0,0.12);
}

/* Replied message */
.message-card.replied {
  border-left-color: #28a745;
  background: #f9fff9;
}

/* Unread message */
.message-card.unread {
  border-left-color: #007bff;
}

/* Header */
.message-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.message-name {
  font-weight: 700;
  font-size: 1rem;
  color: #111;
}

.message-date {
  font-size: 0.75rem;
  color: #888;
}

/* Contact details */
.message-email,
.message-phone {
  font-size: 0.85rem;
  color: #555;
  margin-bottom: 4px;
  word-break: break-word;
}

.message-email::before {
  content: "üìß ";
}

.message-phone::before {
  content: "üìû ";
}

/* Message body */
.message-text {
  margin-top: 8px;
  padding: 12px 14px;
  background: #f6f6f6;
  border-radius: 8px;
  border-left: 4px solid #ff0033;
  font-size: 0.9rem;
  line-height: 1.6;
  color: #333;
}

/* Actions */
.message-actions {
  margin-top: 14px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.message-actions a,
.message-actions button {
  padding: 7px 14px;
  font-size: 0.8rem;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  text-decoration: none;
  color: #fff;
  transition: background 0.2s ease, transform 0.15s ease;
}

.message-actions button:hover,
.message-actions a:hover {
  transform: scale(1.05);
}

/* Buttons */
.reply-btn {
  background: #007bff;
}

.reply-btn:hover {
  background: #005ecb;
}

.delete-btn {
  background: #ff0033;
}

.delete-btn:hover {
  background: #cc0028;
}

/* Mobile optimization */
@media (max-width: 600px) {
  .message-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 4px;
  }

  .message-text {
    font-size: 0.88rem;
  }

  .message-actions {
    gap: 8px;
  }
} 
</style>
</head>

<body>

<!-- ================= ADMIN LOGIN OVERLAY ================= -->
<div id="loginOverlay">
  <div class="login-container">

    <!-- HEADER -->
    <div class="login-header">
      <h1>GLOBAL  HIGH SCHOOL </h1>
      <p>Administration Portal</p>
      <p>Protected by markmellon industries </p>
    </div>

    <!-- LOGIN BOX -->
    <div class="login-box">
      <h3>üîê Admin Login</h3>

      <input type="email" id="adminEmail" placeholder="Email address">
      <input type="password" id="adminPassword" placeholder="Password">

      <button class="btn-primary" onclick="login()">Login</button>

      <p id="loginError"></p>
    </div>

  </div>
</div>

<header>
  <div class="header-left">
    <div class="logo">
  <img 
    src="https://i.ibb.co/mrWQCrrb/blob.jpg"
    alt="GHS Logo"
  >
</div>
      <strong>GLOBAL ADMIN PANEL</strong><br>
      <small>Secure Control Center</small>
    </div>
  </div>
  <div class="header-right">
    <span class="status-dot"></span>
    <span>Online</span>
  </div>
</header>

<div class="container">
  
  <!-- ================= FIREBASE ================= -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // ‚úÖ Initialize Firebase
  if (!firebase.apps.length) {
    firebase.initializeApp({
      apiKey: "AIzaSyBoJdGfyASAGwxVlwqaF7a1aZqp_i6MXFg",
      authDomain: "global-high-a001d.firebaseapp.com",
      databaseURL: "https://global-high-a001d-default-rtdb.firebaseio.com",
      projectId: "global-high-a001d",
      appId: "1:966103646546:web:cf2198f5b8384ac85d3a8"
    });
  }
</script>
<!-- ================= ANALYTICS ADMIN CARD ================= -->
<div class="admin-card" id="analyticsAdminCard">
  <h2>üìä Website Analytics</h2>

  <div class="analytics-grid">
    <div class="analytics-box">
      <span class="icon">üë•</span>
      <div class="label">Total Visitors</div>
      <div class="value" id="adminTotalVisitors">0</div>
    </div>

    <div class="analytics-box">
      <span class="icon">üñ±Ô∏è</span>
      <div class="label">Total Clicks</div>
      <div class="value" id="adminTotalClicks">0</div>
    </div>

    <div class="analytics-box live">
      <span class="icon">üü¢</span>
      <div class="label">People Online</div>
      <div class="value" id="adminPeopleOnline">0</div>
    </div>
  </div>
</div>

<style>
/* ================= ANALYTICS ADMIN CSS ================= */
.admin-card {
  background: #111827;
  padding: 25px;
  border-radius: 12px;
  margin-bottom: 25px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.4);
}
.admin-card h2 {
  margin-bottom: 20px;
  font-size: 1.4rem;
  color: #fff;
}
.analytics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 18px;
}
.analytics-box {
  background: #020617;
  border-radius: 14px;
  padding: 20px;
  text-align: center;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05);
}
.analytics-box .icon {
  font-size: 28px;
  display: block;
  margin-bottom: 6px;
}
.analytics-box .label {
  font-size: 13px;
  color: #94a3b8;
  margin-bottom: 6px;
}
.analytics-box .value {
  font-size: 28px;
  font-weight: 700;
  color: #f8fafc;
}
.analytics-box.live .value {
  color: #22c55e;
}
</style>

<script>
/* ================= ANALYTICS ADMIN JS ================= */
(function(){
  if (!firebase || !firebase.database) {
    console.error("Firebase not initialized. Make sure your admin panel already includes Firebase.");
    return;
  }

  const analyticsRef = firebase.database().ref("totalVisitors");

  const totalVisitorsEl = document.getElementById("adminTotalVisitors");
  const totalClicksEl = document.getElementById("adminTotalClicks");
  const peopleOnlineEl = document.getElementById("adminPeopleOnline");

  analyticsRef.on("value", snapshot => {
    const data = snapshot.val() || {};

    const visitors = data.stats?.visitors || 0;
    const clicks = data.stats?.clicks || 0;
    const online = data.online ? Object.keys(data.online).length : 0;

    totalVisitorsEl.textContent = visitors.toLocaleString();
    totalClicksEl.textContent = clicks.toLocaleString();
    peopleOnlineEl.textContent = online.toLocaleString();
  });
})();
</script>
<!-- ================= APPLY SUBMISSIONS ADMIN CARD ================= -->
<div class="admin-card">
  <h2>üì¨ APPLY SUBMISSIONS MAILS</h2>
  <div id="mailsTableContainer">
    Loading submissions...
  </div>
</div>

<style>
/* ================= ADMIN CARD ================= */
.admin-card {
  background: #111827;
  padding: 25px;
  border-radius: 12px;
  margin-bottom: 25px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.4);
  overflow-x: auto; /* allows horizontal scroll on small screens */
}

.admin-card h2 {
  margin-bottom: 20px;
  font-size: 1.5rem;
  color: #fff;
  text-align: center;
}

/* ================= TABLE ================= */
table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  min-width: 600px; /* allow scroll on mobile */
}

thead {
  background: #1e293b;
}

th, td {
  padding: 12px 14px;
  text-align: left;
  font-size: 14px;
  color: #f8fafc; /* ensure high contrast */
  border-bottom: 1px solid #2e3a52; /* subtle row separation */
}

th {
  font-weight: 700;
  letter-spacing: 0.5px;
}

tbody tr:nth-child(even) {
  background: #0f172a;
}

tbody tr:nth-child(odd) {
  background: #111827;
}

tbody tr:hover {
  background: #1f2937;
  transition: background 0.3s;
}

/* ================= BUTTON ================= */
.delete-btn {
  background: #ef4444;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s;
}

.delete-btn:hover {
  background: #dc2626;
}

/* ================= RESPONSIVE ================= */
@media (max-width: 768px) {
  th, td {
    font-size: 13px;
    padding: 10px 8px;
  }

  table {
    min-width: unset;
  }
}

@media (max-width: 480px) {
  .admin-card {
    padding: 20px 15px;
  }

  th, td {
    font-size: 12px;
    padding: 8px 6px;
  }

  .delete-btn {
    padding: 5px 8px;
    font-size: 11px;
  }
}
</style>

<script>
/* ================= FIREBASE REF ================= */
const mailsRef = firebase.database().ref("mails");
const mailsTableContainer = document.getElementById("mailsTableContainer");

/* ================= LOAD SUBMISSIONS ================= */
function renderMails(snapshot) {
  const data = snapshot.val();
  if (!data) {
    mailsTableContainer.innerHTML = "<p style='color:#94a3b8;'>No submissions yet.</p>";
    return;
  }

  let tableHTML = `
    <table>
      <thead>
        <tr>
          <th>First Name</th>
          <th>Second Name</th>
          <th>Phone</th>
          <th>Residence</th>
          <th>Description</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
  `;

  Object.entries(data).sort((a,b) => b[1].createdAt - a[1].createdAt).forEach(([id, mail]) => {
    const date = new Date(mail.createdAt).toLocaleString();
    tableHTML += `
      <tr>
        <td>${mail.firstName}</td>
        <td>${mail.secondName}</td>
        <td>${mail.phoneNumber}</td>
        <td>${mail.residence}</td>
        <td>${mail.description}</td>
        <td>${date}</td>
        <td><button class="delete-btn" onclick="deleteMail('${id}')">Delete</button></td>
      </tr>
    `;
  });

  tableHTML += `</tbody></table>`;
  mailsTableContainer.innerHTML = tableHTML;
}

/* ================= REAL-TIME LISTENER ================= */
mailsRef.on("value", snapshot => {
  renderMails(snapshot);
});

/* ================= DELETE FUNCTION ================= */
function deleteMail(id) {
  if(!confirm("Are you sure you want to delete this submission?")) return;
  mailsRef.child(id).remove();
}
</script>

<!-- ================= MAINTENANCE ADMIN CARD ================= -->
<div class="admin-card">
  <h2>üöß Maintenance Mode</h2>
  <p>Control website availability</p>

  <div class="toggle-row">
    <span>Maintenance Status</span>
    <label class="switch">
      <input type="checkbox" id="maintenanceToggle">
      <span class="slider"></span>
    </label>
  </div>

  <label>Maintenance Message</label>
  <textarea id="maintenanceMessage" placeholder="We are currently undergoing maintenance..."></textarea>

  <label>Background Image URL</label>
  <input type="text" id="maintenanceBg" placeholder="https://example.com/bg.jpg">

  <button id="saveMaintenanceBtn">Save Settings</button>
  <div class="status" id="maintenanceStatusText"></div>
</div>

<style>
.admin-card {
  background: #111827;
  padding: 25px;
  border-radius: 12px;
  margin-bottom: 25px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.4);
}
.admin-card h2 {
  margin-bottom: 10px;
  font-size: 1.4rem;
  color: #fff;
}
.admin-card p {
  margin-bottom: 20px;
  font-size: 13px;
  color: #94a3b8;
}
label { display:block; margin:12px 0 6px; font-size:13px; color:#94a3b8; }
input, textarea {
  width:100%; padding:10px 12px; border-radius:10px; border:none;
  font-size:13px; color:#fff; background:#1f2933;
}
textarea { min-height:80px; resize:vertical; }
.toggle-row { display:flex; justify-content:space-between; align-items:center; margin-bottom:18px; }
.switch { position: relative; width:50px; height:26px; }
.switch input { opacity:0; width:0; height:0; }
.slider {
  position: absolute; inset:0; background: #475569; border-radius:999px; transition:0.3s;
}
.slider:before {
  content:""; position:absolute; width:22px; height:22px; left:2px; bottom:2px; background:#fff; border-radius:50%; transition:0.3s;
}
.switch input:checked + .slider { background:#22c55e; }
.switch input:checked + .slider:before { transform:translateX(24px); }
button {
  width:100%; margin-top:18px; padding:12px; background:#22c55e; border:none; border-radius:10px;
  font-size:14px; font-weight:600; cursor:pointer;
}
button:hover { background:#16a34a; }
.status { font-size:12px; color:#94a3b8; text-align:center; margin-top:10px; }
</style>

<script>
/* ================= FIREBASE MAINTENANCE REF ================= */
const maintenanceRef = firebase.database().ref("maintenance");

/* ELEMENTS */
const maintenanceToggle = document.getElementById("maintenanceToggle");
const maintenanceMessage = document.getElementById("maintenanceMessage");
const maintenanceBg = document.getElementById("maintenanceBg");
const saveMaintenanceBtn = document.getElementById("saveMaintenanceBtn");
const maintenanceStatusText = document.getElementById("maintenanceStatusText");

/* LOAD EXISTING SETTINGS */
maintenanceRef.on("value", snapshot => {
  const data = snapshot.val();
  if (!data) return;
  maintenanceToggle.checked = !!data.enabled;
  maintenanceMessage.value = data.message || "";
  maintenanceBg.value = data.backgroundImage || "";
});

/* SAVE SETTINGS */
saveMaintenanceBtn.addEventListener("click", () => {
  maintenanceRef.set({
    enabled: maintenanceToggle.checked,
    message: maintenanceMessage.value.trim(),
    backgroundImage: maintenanceBg.value.trim()
  });

  maintenanceStatusText.textContent = "‚úÖ Settings saved successfully";
  setTimeout(() => maintenanceStatusText.textContent = "", 3000);
});
</script>

<!-- ================= ADVERTISEMENT ADMIN CARD ================= -->
<div class="admin-card">
  <h2>üì¢ Advertisements</h2>
  <p>Manage ads & view clicks</p>

  <div class="toggle-row">
    <span>Enable Ads</span>
    <label class="switch">
      <input type="checkbox" id="adsToggle">
      <span class="slider"></span>
    </label>
  </div>

  <label>Ad Image URL</label>
  <input type="text" id="adImage">

  <label>Redirect URL (optional)</label>
  <input type="text" id="adLink">

  <button id="addAdBtn">‚ûï Add Advertisement</button>

  <div class="pdf-grid" id="adsList"></div>
</div>

<script>
const adsRef = firebase.database().ref("advertisements");

const adsToggle = document.getElementById("adsToggle");
const adImage = document.getElementById("adImage");
const adLink = document.getElementById("adLink");
const adsList = document.getElementById("adsList");

/* LOAD ADS */
adsRef.on("value", snap => {
  const data = snap.val() || {};
  adsToggle.checked = !!data.enabled;
  adsList.innerHTML = "";

  if (!data.images) return;

  Object.entries(data.images)
    .sort((a,b) => (b[1].clicks||0) - (a[1].clicks||0))
    .forEach(([id, ad]) => {
      const card = document.createElement("div");
      card.className = "pdf-card";
      card.innerHTML = `
        <img src="${ad.imageUrl}" style="width:100%;border-radius:10px;">
        <div class="pdf-title">Clicks: ${ad.clicks || 0}</div>
        <div class="pdf-category">${ad.linkUrl || "No redirect"}</div>
        <div class="pdf-actions">
          <button class="delete-btn" onclick="deleteAd('${id}')">Delete</button>
        </div>
      `;
      adsList.appendChild(card);
    });
});

/* TOGGLE ADS */
adsToggle.onchange = () => {
  adsRef.update({ enabled: adsToggle.checked });
};

/* ADD AD */
document.getElementById("addAdBtn").onclick = () => {
  if (!adImage.value.trim()) return alert("Image URL required");

  adsRef.child("images").push({
    imageUrl: adImage.value.trim(),
    linkUrl: adLink.value.trim(),
    clicks: 0,
    createdAt: Date.now()
  });

  adImage.value = "";
  adLink.value = "";
};

/* DELETE */
function deleteAd(id) {
  if (!confirm("Delete this ad?")) return;
  adsRef.child("images").child(id).remove();
}
</script>

  <!-- ===== LIVE WEBSITE PREVIEW ===== -->
<div class="card">
  <h2>üåç Live Website Preview</h2>
  <p style="text-align:center;color:#666;margin-bottom:15px;">
    See your website updates in real time
  </p>

  <button class="btn-primary" style="margin-bottom:15px;" onclick="refreshPreview()">
    üîÑ Refresh Preview
  </button>

  <div style="border-radius:12px;overflow:hidden;border:1px solid #ddd;">
    <iframe 
      id="livePreview"
      src="https://markmellon3.github.io/GLOBAL-HIGH-/"
      style="width:100%;height:600px;border:none;">
    </iframe>
  </div>
</div>
  
<!-- IMAGE UPLOAD -->
<div class="card">
  <h2>üì∏ Image Upload (Public Link)</h2>

  <input 
    type="file" 
    id="imageFile" 
    accept="image/*"
    onchange="previewBeforeUpload()"
  >

  <img 
    id="imagePreview"
    style="
      display:none;
      width:100%;
      max-height:240px;
      object-fit:cover;
      border-radius:12px;
      margin:15px 0;
    "
  >
<div id="imageLoader" class="image-loader"></div>
  <button class="btn-primary" onclick="uploadImage()">Upload Image</button>

  <input id="imageLink" readonly placeholder="Image URL">
</div>
  <!-- GALLERY -->
  <div class="card">
    <h2>üñº Gallery Manager</h2>
    <form id="imageForm">
      <input type="hidden" id="imageId">
      <input type="url" id="imageUrl" placeholder="Image URL" required>
      <button class="btn-primary">Save Image</button>
    </form>
    <div class="grid" id="gallery"></div>
  </div>

  <!-- NEWS -->
  <div class="card">
    <h2>üì¢ News Manager</h2>
    <form id="newsForm">
      <input type="hidden" id="newsId">
      <input type="text" id="newsTitle" placeholder="Title" required>
      <input type="date" id="newsDate" required>
      <textarea id="newsContent" rows="4" placeholder="News Content" required></textarea>
      <button class="btn-primary">Save News</button>
    </form>
    <div id="newsList" class="grid"></div>
  </div>

</div>
<!-- EVENTS MANAGER -->
<div class="card">
  <h2>üìÖ Events Manager</h2>
  <form id="eventForm">
    <input type="hidden" id="eventId">
    <input type="text" id="eventTitle" placeholder="Event Title" required>
    <input type="date" id="eventDate" required>
    <input type="text" id="eventCategory" placeholder="Category (e.g., Academic, Arts, Sports)" required>
    <input type="text" id="eventImage" placeholder="Image URL" required>
    <textarea id="eventContent" rows="4" placeholder="Event Description" required></textarea>
    <input type="text" id="eventLink" placeholder="Optional Link">
    <button class="btn-primary">Save Event</button>
  </form>
  <div id="eventList" class="grid"></div>
</div>
<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyBoJdGfyASAGwxVlwqaF7a1aZqp_i6MXFg",
  authDomain:"global-high-a001d.firebaseapp.com",
  databaseURL:"https://global-high-a001d-default-rtdb.firebaseio.com",
  projectId:"global-high-a001d",
  appId:"1:966103646546:web:cf2198f5b8384ac85d3a8b"
});

const db=firebase.database();
const auth=firebase.auth();
</script>

<script>
function login(){
  auth.signInWithEmailAndPassword(
    adminEmail.value,
    adminPassword.value
  ).catch(e=>loginError.textContent=e.message);
}

auth.onAuthStateChanged(user=>{
  loginOverlay.style.display=user?"none":"flex";
});
</script>

<script>
const galleryRef=db.ref("gallery");
galleryRef.on("value",snap=>{
  gallery.innerHTML="";
  snap.forEach(c=>{
    gallery.innerHTML+=`
      <div class="image-card card">
        <img src="${c.val().url}">
        <button class="btn-danger" onclick="galleryRef.child('${c.key}').remove()">Delete</button>
      </div>`;
  });
});

imageForm.onsubmit=e=>{
  e.preventDefault();
  galleryRef.push({url:imageUrl.value});
  imageForm.reset();
};
</script>

<script>
const newsRef=db.ref("news");
newsRef.on("value",snap=>{
  newsList.innerHTML="";
  snap.forEach(c=>{
    newsList.innerHTML+=`
      <div class="card">
        <small>${c.val().date}</small>
        <h3>${c.val().title}</h3>
        <p>${c.val().content}</p>
        <button class="btn-danger" onclick="newsRef.child('${c.key}').remove()">Delete</button>
      </div>`;
  });
});

newsForm.onsubmit=e=>{
  e.preventDefault();
  newsRef.push({
    title:newsTitle.value,
    date:newsDate.value,
    content:newsContent.value
  });
  newsForm.reset();
};
</script>

<script>
const IMGBB_KEY="47f7dff148164ff31a5947e6ee635363";
async function uploadImage(){
  const file=imageFile.files[0];
  if(!file) return alert("Select image");
  const fd=new FormData();
  fd.append("image",file);
  const r=await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`,{method:"POST",body:fd});
  const d=await r.json();
  imageLink.value=d.data.url;
}
document.getElementById("imagePreview").style.display = "none";
</script>
<script>
function refreshPreview(){
  const iframe = document.getElementById("livePreview");
  iframe.src = iframe.src;
}
</script>
<script>
function previewBeforeUpload(){
  const file = document.getElementById("imageFile").files[0];
  const preview = document.getElementById("imagePreview");
  const loader = document.getElementById("imageLoader");

  if(!file){
    preview.style.display = "none";
    loader.style.display = "none";
    return;
  }

  loader.style.display = "block";
  preview.style.display = "none";

  const reader = new FileReader();
  reader.onload = e => {
    preview.src = e.target.result;
    preview.style.display = "block";
    loader.style.display = "none";
  };
  reader.readAsDataURL(file);
}
document.getElementById("imageLoader").style.display = "block";
document.getElementById("imageLoader").style.display = "none";
</script>
<script>
  // ================= ADMIN PANEL ELEMENTS =================
  const eventForm = document.getElementById('eventForm');
  const eventIdInput = document.getElementById('eventId');
  const eventTitle = document.getElementById('eventTitle');
  const eventDate = document.getElementById('eventDate');
  const eventCategory = document.getElementById('eventCategory');
  const eventImage = document.getElementById('eventImage');
  const eventContent = document.getElementById('eventContent');
  const eventLink = document.getElementById('eventLink');
  const eventList = document.getElementById('eventList');

  // ================= FIREBASE REFERENCE =================
  const eventsRef = firebase.database().ref('events');

  // ================= ADD OR UPDATE EVENT =================
  eventForm.addEventListener('submit', e => {
    e.preventDefault();

    const id = eventIdInput.value || eventsRef.push().key;

    // Clean and sanitize data
    const eventData = {
      title: eventTitle.value.trim() || 'Untitled Event',
      date: eventDate.value || new Date().toISOString().split('T')[0],
      category: eventCategory.value.trim() || 'GENERAL',
      image: eventImage.value.trim() || 'https://via.placeholder.com/400x250',
      content: eventContent.value.trim() || '',
      link: eventLink.value.trim() || '#',
      createdAt: Date.now() // timestamp for sorting or analytics
    };

    // Save to Firebase
    eventsRef.child(id).set(eventData)
      .then(() => {
        alert('Event saved successfully!');
        eventForm.reset();
        eventIdInput.value = '';
      })
      .catch(err => console.error('Firebase Error:', err));
  });

  // ================= DISPLAY EVENT LIST IN ADMIN =================
  function renderEventList() {
    eventList.innerHTML = '';
    eventsRef.once('value').then(snapshot => {
      const data = snapshot.val();
      if (!data) {
        eventList.innerHTML = '<p>No events available</p>';
        return;
      }

      // Sort by date newest first
      const items = Object.entries(data).sort((a,b) => new Date(b[1].date) - new Date(a[1].date));

      items.forEach(([id, item]) => {
        const card = document.createElement('div');
        card.className = 'news-card';
        card.innerHTML = `
          <h3>${item.title}</h3>
          <p><strong>Date:</strong> ${item.date}</p>
          <p><strong>Category:</strong> ${item.category}</p>
          <p>${item.content}</p>
          <div class="news-actions">
            <button class="edit-btn" data-id="${id}">Edit</button>
            <button class="delete-btn" data-id="${id}">Delete</button>
          </div>
        `;
        eventList.appendChild(card);
      });

      // ================= EDIT EVENT =================
      document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.dataset.id;
          const item = data[id];
          eventIdInput.value = id;
          eventTitle.value = item.title;
          eventDate.value = item.date;
          eventCategory.value = item.category;
          eventImage.value = item.image;
          eventContent.value = item.content;
          eventLink.value = item.link || '';
        });
      });

      // ================= DELETE EVENT =================
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.dataset.id;
          if (confirm('Are you sure you want to delete this event?')) {
            eventsRef.child(id).remove();
          }
        });
      });
    });
  }

  // ================= LISTEN FOR REAL-TIME CHANGES =================
  eventsRef.on('value', renderEventList);

  // ================= WEBSITE DISPLAY =================
  const newsContainer = document.getElementById('newsContainer');
  if (newsContainer) {
    eventsRef.on('value', snapshot => {
      newsContainer.innerHTML = '';
      const data = snapshot.val();

      if (!data) {
        newsContainer.innerHTML = '<p>No events available</p>';
        return;
      }

      // Convert Firebase object to array and sort by date (newest first)
      const items = Object.values(data)
        .map(item => ({
          title: item.title || 'Untitled Event',
          date: item.date || new Date().toISOString().split('T')[0],
          category: item.category || 'GENERAL',
          image: item.image || 'https://via.placeholder.com/400x250', // fallback image
          link: item.link || '#',
          content: item.content || ''
        }))
        .sort((a, b) => new Date(b.date) - new Date(a.date));

      items.forEach(item => {
        const card = document.createElement('div');
        card.style.cssText = `
          position:relative; border-radius:12px; overflow:hidden;
          box-shadow:0 8px 25px rgba(0,0,0,0.1); background:#fff;
        `;

        card.innerHTML = `
          <img src="${item.image}" alt="${item.title}" style="width:100%; height:200px; object-fit:cover;">
          <div style="position:absolute; top:15px; left:15px; background:#fff; padding:5px 10px; font-weight:700; font-size:0.9rem; border-radius:6px;">
            ${formatDate(item.date)}
          </div>
          <div style="position:absolute; bottom:15px; left:15px; background:#ff0033; color:#fff; padding:5px 10px; font-size:0.8rem; font-weight:700; border-radius:6px;">
            ${item.category.toUpperCase()}
          </div>
          <div style="padding:15px;">
            <h3 style="margin:0 0 10px 0; font-size:1.1rem; font-weight:700;">${item.title}</h3>
            <p style="color:#555; font-size:0.9rem; margin-bottom:10px;">${item.content}</p>
            <a href="${item.link}" style="color:#555; font-size:0.9rem; text-decoration:none; font-weight:500;">READ MORE ‚Üí</a>
          </div>
        `;

        newsContainer.appendChild(card);
      });
    });
  }

  // ================= HELPER: FORMAT DATE =================
  function formatDate(dateStr) {
    const months = ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];
    const d = new Date(dateStr);
    if (isNaN(d)) return dateStr; // fallback for invalid date
    const day = d.getDate().toString().padStart(2,'0');
    const month = months[d.getMonth()];
    return `${day} ${month}`;
  }
</script>

<!-- ================= CAMPUS LIFE ADMIN BLOCK ================= -->
<style>
  /* ================= CAMPUS LIFE ADMIN CSS ================= */
  .admin-card {
    background: #ffffff;
    padding: 25px;
    border-radius: 14px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    margin-bottom: 30px;
    border: 1px solid #eee;
  }

  .admin-card h2 {
    margin-bottom: 20px;
    font-size: 1.6rem;
    color: #1a1a37;
    font-weight: 600;
  }

  .admin-form {
    display: grid;
    gap: 15px;
  }

  .admin-form input,
  .admin-form select,
  .admin-form button {
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #ddd;
    font-size: 15px;
    width: 100%;
  }

  .admin-form button {
    background: var(--primary);
    color: #fff;
    border: none;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s;
  }

  .admin-form button:hover {
    background: var(--primary-dark);
  }

  #campusImageList {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 10px;
  }

  .admin-item {
    display: flex;
    gap: 15px;
    align-items: center;
    background: #fdfdfd;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #eee;
  }

  .admin-item img {
    width: 100px;
    height: 70px;
    object-fit: cover;
    border-radius: 6px;
  }

  .admin-info {
    flex: 1;
    font-size: 13px;
    word-break: break-all;
  }

  .delete-btn {
    background: #fff1f2;
    color: #dc2626;
    border: none;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  }

  .delete-btn:hover {
    background: #fcdcdc;
  }
</style>

<div class="admin-card">
  <h2>Add Campus Life Image</h2>
  <form id="campusImageForm" class="admin-form">
    <input type="url" id="campusImageUrl" placeholder="Paste Image URL here..." required>
    <select id="campusImageType">
      <option value="normal">Normal</option>
      <option value="trophy">Trophy (Big Left)</option>
      <option value="lab">Lab (Wide Bottom)</option>
    </select>
    <button type="submit" id="campusSaveBtn">Save Image</button>
  </form>
</div>

<div class="admin-card">
  <h2>Manage Campus Life Images</h2>
  <div id="campusImageList">Loading database...</div>
</div>

<script>
  // ===== CAMPUS LIFE IMAGE LOGIC =====
  const campusImagesRef = firebase.database().ref("campusLifeImages");

  const campusImageForm = document.getElementById("campusImageForm");
  const campusImageList = document.getElementById("campusImageList");
  const campusImageUrl = document.getElementById("campusImageUrl");
  const campusImageType = document.getElementById("campusImageType");
  const campusSaveBtn = document.getElementById("campusSaveBtn");

  // Add image
  campusImageForm.addEventListener("submit", e => {
    e.preventDefault();
    const url = campusImageUrl.value.trim();
    const type = campusImageType.value;
    if (!url) { alert("Please enter a valid URL."); return; }

    campusSaveBtn.disabled = true;
    campusSaveBtn.innerText = "Saving...";

    campusImagesRef.push({ url, type, createdAt: firebase.database.ServerValue.TIMESTAMP })
      .then(() => {
        alert("Saved!");
        campusImageForm.reset();
      })
      .catch(err => alert("Error: " + err.message))
      .finally(() => {
        campusSaveBtn.disabled = false;
        campusSaveBtn.innerText = "Save Image";
      });
  });

  // Real-time load
  campusImagesRef.on("value", snapshot => {
    campusImageList.innerHTML = "";
    const data = snapshot.val();
    if (!data) {
      campusImageList.innerHTML = "<p>No images found.</p>";
      return;
    }

    // Sort by newest first
    Object.entries(data)
      .sort((a, b) => b[1].createdAt - a[1].createdAt)
      .forEach(([id, item]) => {
        const div = document.createElement("div");
        div.className = "admin-item";
        div.innerHTML = `
          <img src="${item.url}" onerror="this.src='https://via.placeholder.com/100?text=Error'">
          <div class="admin-info"><strong>${item.type.toUpperCase()}</strong><br>${item.url}</div>
          <button class="delete-btn" onclick="campusImagesRef.child('${id}').remove()">Delete</button>
        `;
        campusImageList.appendChild(div);
      });
  });
</script>

<!-- ================= GOOGLE IMAGES ADMIN MODULE ================= -->
<div class="admin-card">
  <h2>üñºÔ∏è Google Images Management</h2>

  <!-- ADD IMAGE -->
  <label>Image URL</label>
  <input type="url" id="googleImageUrl" placeholder="https://i.ibb.co/xxxx/image.jpg">

  <label>Image Title (SEO)</label>
  <input type="text" id="googleImageTitle" placeholder="Global High School Entebbe">

  <label>Description (SEO)</label>
  <textarea id="googleImageDescription"></textarea>

  <div class="preview" id="googleImagePreview">
    <img id="googlePreviewImg">
  </div>

  <button id="googleAddImageBtn">Add Image</button>
  <div class="status" id="googleFormStatus"></div>
</div>

<!-- IMAGE LIST -->
<div class="admin-card">
  <h2>Uploaded Google Images</h2>
  <div class="gallery-grid" id="googleAdminGallery"></div>
</div>
<style>

/* ================= ADMIN CARD ================= */
.admin-card {
  background: #0f172a;
  padding: 25px;
  border-radius: 16px;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6);
  margin-bottom: 30px;
  transition: transform 0.3s, box-shadow 0.3s;
}
.admin-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 20px 45px rgba(0, 0, 0, 0.7);
}
.admin-card h2 {
  font-size: 1.4rem;
  color: #fff;
  margin-bottom: 20px;
}

/* ================= FORM ELEMENTS ================= */
label {
  font-size: 13px;
  color: #94a3b8;
  display: block;
  margin: 12px 0 5px;
}

input, textarea {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: #111827;
  color: #f8fafc;
  font-size: 14px;
}

textarea {
  resize: vertical;
  min-height: 80px;
}

button {
  margin-top: 15px;
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: #22c55e;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s, transform 0.2s;
}
button:hover {
  background: #16a34a;
  transform: scale(1.02);
}

.status {
  text-align: center;
  margin-top: 10px;
  font-size: 13px;
  color: #94a3b8;
}

/* ================= IMAGE PREVIEW ================= */
.preview {
  margin-top: 15px;
  border-radius: 12px;
  overflow: hidden;
  display: none;
  border: 1px solid #1f2937;
  background: #111827;
}
.preview img {
  width: 100%;
  max-height: 220px;
  object-fit: cover;
  display: block;
}

/* ================= GALLERY GRID ================= */
.gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

/* ================= GALLERY CARD ================= */
.gallery-item {
  background: #111827;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
  transition: transform 0.3s, box-shadow 0.3s;
}
.gallery-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.7);
}

.gallery-item img {
  width: 100%;
  height: 180px;
  object-fit: cover;
}

.gallery-info {
  padding: 12px;
}

.gallery-info h4 {
  font-size: 14px;
  margin: 0 0 6px;
  color: #fff;
}

.gallery-info p {
  font-size: 12px;
  color: #94a3b8;
  margin: 0 0 10px;
}

.delete-btn {
  width: 100%;
  background: #ef4444;
  padding: 8px;
  border-radius: 8px;
  border: none;
  font-size: 12px;
  color: #fff;
  cursor: pointer;
  transition: background 0.3s;
}
.delete-btn:hover {
  background: #dc2626;
}

/* ================= MOBILE RESPONSIVE ================= */
@media (max-width: 480px) {
  .admin-card {
    padding: 20px 15px;
  }
  .gallery-info h4 {
    font-size: 13px;
  }
  .gallery-info p {
    font-size: 11px;
  }
  .delete-btn {
    font-size: 11px;
    padding: 6px;
  }
  button {
    font-size: 13px;
    padding: 10px;
  }
} 


</style>
<script>
/* ================= GOOGLE IMAGES ADMIN SCRIPT ================= */
/* Firebase must already be initialized in main admin panel */

// Use the correct Firebase node
const googleImagesRef = firebase.database().ref("google");

/* ELEMENTS */
const gImageUrl = document.getElementById("googleImageUrl");
const gImageTitle = document.getElementById("googleImageTitle");
const gImageDesc = document.getElementById("googleImageDescription");
const gAddBtn = document.getElementById("googleAddImageBtn");
const gFormStatus = document.getElementById("googleFormStatus");
const gPreview = document.getElementById("googleImagePreview");
const gPreviewImg = document.getElementById("googlePreviewImg");
const gGallery = document.getElementById("googleAdminGallery");

/* IMAGE PREVIEW */
gImageUrl.addEventListener("input", () => {
  const url = gImageUrl.value.trim();
  if (url.match(/\.(jpg|jpeg|png|webp|gif)$/i)) {
    gPreview.style.display = "block";
    gPreviewImg.src = url;
  } else {
    gPreview.style.display = "none";
  }
});

/* ADD IMAGE */
gAddBtn.addEventListener("click", () => {
  const url = gImageUrl.value.trim();
  const title = gImageTitle.value.trim();
  const desc = gImageDesc.value.trim();

  if (!url || !title) {
    gFormStatus.textContent = "‚ùå Image URL and Title are required.";
    return;
  }

  gAddBtn.disabled = true;
  gAddBtn.textContent = "Adding...";

  googleImagesRef.push({
    imageUrl: url,
    title: title,
    description: desc,
    createdAt: Date.now()
  }).then(() => {
    gFormStatus.textContent = "‚úÖ Image added!";
    gImageUrl.value = "";
    gImageTitle.value = "";
    gImageDesc.value = "";
    gPreview.style.display = "none";
    gAddBtn.disabled = false;
    gAddBtn.textContent = "Add Image";
  }).catch(err => {
    gFormStatus.textContent = "‚ùå " + err.message;
    gAddBtn.disabled = false;
    gAddBtn.textContent = "Add Image";
  });
});

/* LOAD IMAGES */
googleImagesRef.orderByChild("createdAt").on("value", snap => {
  gGallery.innerHTML = "";
  snap.forEach(child => {
    const data = child.val();
    const key = child.key;

    const div = document.createElement("div");
    div.className = "gallery-item";
    div.innerHTML = `
      <img src="${data.imageUrl}" alt="${data.title}">
      <div class="gallery-info">
        <h4>${data.title}</h4>
        <p>${data.description || ""}</p>
        <button class="delete-btn">Delete</button>
      </div>
    `;

    // DELETE IMAGE
    div.querySelector(".delete-btn").onclick = () => {
      if (confirm("Delete this image?")) googleImagesRef.child(key).remove();
    };

    gGallery.appendChild(div);
  });
});
</script>
<!-- ================= DOCUMENTS ADMIN PANEL ================= -->
<section class="docs-admin">

  <h2 class="docs-title">üìÇ Documents Manager</h2>

  <!-- ADD DOCUMENT -->
  <div class="docs-card">
    <h3>Add New Document</h3>

    <label>Document Title</label>
    <input type="text" id="docTitle" placeholder="e.g. Admission Form">

    <label>Document Image / PDF Preview URL</label>
    <input type="text" id="docImage" placeholder="https://...">

    <button id="addDocBtn">‚ûï Add Document</button>
  </div>

  <!-- DOCUMENT LIST -->
  <div class="docs-card">
    <h3>Existing Documents</h3>
    <div class="docs-grid" id="documentsGrid">
      Loading documents...
    </div>
  </div>

</section>

<style>
<style>
/* ================= DOCUMENTS ADMIN CSS (RESPONSIVE WHITE UI) ================= */

:root {
  --bg: #f3f4f6;
  --card: #ffffff;
  --border: #e5e7eb;
  --text: #111827;
  --muted: #6b7280;
  --green: #22c55e;
  --green-dark: #16a34a;
  --red: #ef4444;
  --red-dark: #dc2626;
}

body {
  background: var(--bg);
}

/* WRAPPER */
.docs-admin {
  max-width: 1200px;
  margin: 40px auto;
  padding: 0 16px;
  font-family: 'Inter', sans-serif;
}

/* TITLE */
.docs-title {
  text-align: center;
  margin-bottom: 30px;
  font-size: clamp(1.5rem, 4vw, 2rem);
  color: var(--text);
}

/* CARD */
.docs-card {
  background: var(--card);
  padding: 24px;
  border-radius: 16px;
  border: 1px solid var(--border);
  box-shadow: 0 10px 25px rgba(0,0,0,.08);
  margin-bottom: 30px;
}

/* HEADINGS */
.docs-card h3 {
  margin-bottom: 18px;
  font-size: 1.2rem;
  color: var(--text);
}

/* LABEL */
.docs-card label {
  display: block;
  font-weight: 600;
  margin-bottom: 6px;
  color: var(--text);
}

/* INPUT */
.docs-card input {
  width: 100%;
  padding: 14px;
  border-radius: 10px;
  border: 1px solid var(--border);
  margin-bottom: 16px;
  background: #8e8e8e;
  color: var(--text);
  font-size: 0.95rem;
}

.docs-card input:focus {
  outline: none;
  border-color: var(--green);
}

/* BUTTON */
.docs-card button {
  width: 100%;
  padding: 14px;
  border-radius: 10px;
  border: none;
  font-weight: 700;
  cursor: pointer;
  background: var(--green);
  color: #122fd5;
  font-size: 1rem;
  transition: background 0.2s ease;
}

.docs-card button:hover {
  background: var(--green-dark);
}

/* GRID */
.docs-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
}

/* DOCUMENT ITEM */
.docs-item {
  background: #ffffff;
  border-radius: 14px;
  padding: 15px;
  border: 1px solid var(--border);
  box-shadow: 0 6px 18px rgba(0,0,0,.08);
  display: flex;
  flex-direction: column;
}

/* IMAGE */
.docs-item img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  border-radius: 10px;
  margin-bottom: 12px;
}

/* TITLE */
.docs-item-title {
  font-weight: 600;
  margin-bottom: 12px;
  color: var(--text);
  font-size: 0.95rem;
}

/* DELETE BUTTON */
.docs-delete {
  margin-top: auto;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: var(--red);
  color: #008e31;
  font-weight: 600;
  cursor: pointer;
  font-size: 0.9rem;
  transition: background 0.2s ease;
}

.docs-delete:hover {
  background: var(--red-dark);
}

/* ================= MOBILE OPTIMIZATION ================= */
@media (max-width: 600px) {

  .docs-card {
    padding: 18px;
  }

  .docs-item img {
    height: 160px;
  }

  .docs-card button,
  .docs-delete {
    padding: 14px;
    font-size: 1rem;
  }
}
</style>

<script>
/* ================= DOCUMENTS ADMIN LOGIC ================= */
/* Uses EXISTING Firebase initialization */

const documentsRef = firebase.database().ref("documents");

const grid = document.getElementById("documentsGrid");
const addBtn = document.getElementById("addDocBtn");
const docTitle = document.getElementById("docTitle");
const docImage = document.getElementById("docImage");

/* ADD DOCUMENT */
addBtn.addEventListener("click", () => {
  const title = docTitle.value.trim();
  const imageUrl = docImage.value.trim();

  if (!imageUrl) {
    alert("Document image or PDF preview URL is required.");
    return;
  }

  documentsRef.push({
    title: title || "Untitled Document",
    imageUrl: imageUrl,
    createdAt: Date.now()
  });

  docTitle.value = "";
  docImage.value = "";
});

/* LOAD DOCUMENTS (REALTIME & CLEAN RENDER) */
documentsRef.on("value", snapshot => {
  grid.innerHTML = "";

  const data = snapshot.val();

  if (!data) {
    grid.innerHTML = "<p style='color:#9ca3af'>No documents available.</p>";
    return;
  }

  Object.entries(data)
    .sort((a, b) => b[1].createdAt - a[1].createdAt)
    .forEach(([id, doc]) => {

      const div = document.createElement("div");
      div.className = "docs-item";

      div.innerHTML = `
        <img src="${doc.imageUrl}"
             onerror="this.src='https://via.placeholder.com/400x300?text=Preview+Unavailable'">
        <div class="docs-item-title">${doc.title}</div>
        <button class="docs-delete" data-id="${id}">
          üóë Delete
        </button>
      `;

      div.querySelector(".docs-delete").addEventListener("click", () => {
        deleteDocument(id);
      });

      grid.appendChild(div);
    });
});

/* DELETE DOCUMENT (REAL FIREBASE DELETE) */
function deleteDocument(id) {
  if (!confirm("Delete this document permanently?")) return;

  firebase.database()
    .ref("documents/" + id)
    .remove()
    .then(() => {
      console.log("Document deleted:", id);
    })
    .catch(err => {
      console.error("Delete failed:", err);
      alert("Failed to delete document.");
    });
}
</script>

<!-- ================= PDF UPLOAD ADMIN CARD ================= -->
<div class="admin-card">
  <h2>üìÑ PDF Upload Panel ‚Äì Store in DB</h2>

  <label>PDF Title</label>
  <input type="text" id="pdfTitle" placeholder="e.g. Biology Past Paper">

  <label>Category</label>
  <select id="pdfCategory">
    <option value="past papers">Past Papers</option>
    <option value="subjects">Subjects</option>
    <option value="work">Work</option>
  </select>

  <label>Select PDF File</label>
  <input type="file" id="pdfFile" accept="application/pdf">

  <button id="uploadBtn">‚¨Ü Upload PDF</button>
</div>

<!-- ================= UPLOADED PDF LIST ================= -->
<div class="admin-card">
  <h2>Uploaded PDFs</h2>
  <div class="pdf-grid" id="pdfGrid">Loading...</div>
</div>

<style>
/* ================= PROFESSIONAL PDF ADMIN CSS (WHITE UI) ================= */

:root {
  --bg: #f3f4f6;
  --card: #ffffff;
  --border: #d1d5db;
  --text: #111827;
  --muted: #6b7280;
  --green: #14532d;      /* dark green */
  --green-soft: #22c55e;
  --red: #b91c1c;
}

body {
  background: var(--bg);
}

/* ================= ADMIN CARD ================= */
.admin-card {
  background: var(--card);
  padding: 28px;
  border-radius: 16px;
  margin-bottom: 30px;
  box-shadow: 0 12px 26px rgba(0, 0, 0, 0.08);
  border: 1px solid var(--border);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.admin-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 16px 32px rgba(0, 0, 0, 0.12);
}

/* ================= CARD TITLE ================= */
.admin-card h2 {
  margin-bottom: 22px;
  font-size: clamp(1.3rem, 3vw, 1.6rem);
  color: var(--text);
  font-weight: 700;
  border-bottom: 2px solid var(--green);
  padding-bottom: 8px;
}

/* ================= FORM ELEMENTS ================= */
input,
select,
button {
  width: 100%;
  padding: 14px 16px;
  border-radius: 10px;
  margin-bottom: 18px;
  font-size: 15px;
  transition: all 0.2s ease;
}

/* INPUTS */
input,
select {
  background: #b3b3b3;
  color: var(--text);
  border: 1px solid var(--border);
}

input:focus,
select:focus {
  outline: none;
  border-color: var(--green);
  box-shadow: 0 0 0 2px rgba(20, 83, 45, 0.15);
}

/* BUTTONS (BORDERED DARK GREEN) */
button {
  background: transparent;
  color: var(--green);
  font-weight: 700;
  cursor: pointer;
  border: 2px solid var(--green);
}

button:hover {
  background: var(--green);
  color: #ffffff;
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ================= PDF GRID ================= */
.pdf-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 22px;
}

/* ================= PDF CARD ================= */
.pdf-card {
  background: var(--card);
  border-radius: 14px;
  padding: 20px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.08);
  border: 1px solid var(--border);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.pdf-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 14px 28px rgba(0,0,0,0.12);
}

/* ================= TEXT ================= */
.pdf-title {
  font-weight: 600;
  font-size: 1.05rem;
  color: var(--text);
  margin-bottom: 6px;
}

.pdf-category {
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 14px;
}

/* ================= ACTIONS ================= */
.pdf-actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.pdf-actions a,
.pdf-actions button {
  flex: 1;
  padding: 10px 12px;
  border-radius: 8px;
  font-weight: 600;
  font-size: 13px;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s ease;
}

/* VIEW BUTTON */
.view-btn {
  background: transparent;
  border: 2px solid var(--green);
  color: var(--green);
  text-decoration: none;
}

.view-btn:hover {
  background: var(--green);
  color: #ffffff;
}

/* DELETE BUTTON */
.delete-btn {
  background: transparent;
  border: 2px solid var(--red);
  color: var(--red);
}

.delete-btn:hover {
  background: var(--red);
  color: #ffffff;
}

/* ================= RESPONSIVE OPTIMIZATION (ALL DEVICES) ================= */

/* Large screens (desktop & laptops) */
@media (min-width: 1024px) {
  .admin-card {
    padding: 22px;
    max-width: 100%;
  }

  .pdf-grid {
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  }

  .pdf-card {
    padding: 18px;
  }
}

/* Tablets */
@media (max-width: 1023px) and (min-width: 669px) {
  .admin-card {
    padding: 20px;
  }

  .pdf-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .pdf-card {
    padding: 16px;
  }
}

/* Phones */
@media (max-width: 668px) {
  .admin-card {
    padding: 16px;
  }

  .pdf-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }

  .pdf-card {
    padding: 14px;
  }

  .pdf-actions a,
  .pdf-actions button {
    font-size: 14px;
    padding: 10px;
  }
} 
</style>

<script>
/* ===== FIREBASE CONFIG (uses existing initialization) ===== */
const pdfsRef = firebase.database().ref("pdfs");

/* ELEMENTS */
const pdfGrid = document.getElementById("pdfGrid");
const uploadBtn = document.getElementById("uploadBtn");
const pdfTitle = document.getElementById("pdfTitle");
const pdfCategory = document.getElementById("pdfCategory");
const pdfFile = document.getElementById("pdfFile");

/* UPLOAD PDF TO DB */
uploadBtn.addEventListener("click", () => {
  const file = pdfFile.files[0];
  const title = pdfTitle.value.trim();
  const category = pdfCategory.value;

  if (!file) return alert("Select a PDF file.");

  uploadBtn.disabled = true;
  uploadBtn.innerText = "Uploading...";

  const reader = new FileReader();
  reader.onload = () => {
    const base64 = reader.result; // PDF as Base64 string
    pdfsRef.push({
      title,
      category,
      pdfBase64: base64,
      createdAt: Date.now()
    });

    pdfTitle.value = "";
    pdfFile.value = "";
    uploadBtn.disabled = false;
    uploadBtn.innerText = "‚¨Ü Upload PDF";
  };

  reader.onerror = () => {
    alert("Failed to read file.");
    uploadBtn.disabled = false;
    uploadBtn.innerText = "‚¨Ü Upload PDF";
  };

  reader.readAsDataURL(file);
});

/* LOAD PDFs */
pdfsRef.on("value", snapshot => {
  pdfGrid.innerHTML = "";
  const data = snapshot.val();
  if (!data) { pdfGrid.innerHTML = "<p>No PDFs uploaded yet.</p>"; return; }

  Object.entries(data)
    .sort((a,b) => b[1].createdAt - a[1].createdAt)
    .forEach(([id, pdf]) => {
      const card = document.createElement("div");
      card.className = "pdf-card";

      card.innerHTML = `
        <div class="pdf-title">${pdf.title || "Untitled PDF"}</div>
        <div class="pdf-category">${pdf.category}</div>
        <div class="pdf-actions">
          <a class="view-btn" href="${pdf.pdfBase64}" target="_blank" download="${pdf.title || 'document'}.pdf">Download</a>
          <button class="delete-btn" onclick="deletePDF('${id}')">Delete</button>
        </div>
      `;
      pdfGrid.appendChild(card);
    });
});

/* DELETE PDF */
function deletePDF(id) {
  if (!confirm("Delete this PDF?")) return;
  pdfsRef.child(id).remove();
}
</script>
</body>
</html>
